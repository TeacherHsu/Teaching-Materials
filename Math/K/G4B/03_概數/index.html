<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ¦‚æ•¸å­¸ç¿’ç³»çµ±ï¼ˆUDLç‰ˆï¼‰</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{font-size:22px;}
.big{font-size:28px;font-weight:700;}
.btn{
padding:14px 22px;
margin:8px;
border-radius:12px;
border:3px solid #1e40af;
background:white;
}
.btn:hover{background:#dbeafe;}
.panel{border-radius:16px;padding:20px;}
</style>
</head>

<body class="bg-slate-100 min-h-screen flex flex-col">

<header class="bg-white shadow p-4 text-2xl font-bold text-blue-700">
æ¦‚æ•¸å­¸ç¿’ç·´ç¿’ï¼ˆä¸€æ­¥ä¸€æ­¥ä¾†ï¼‰
</header>

<main class="flex flex-col md:flex-row flex-1">

<!-- å·¦å´ï¼šå­¸ç¿’ç‹€æ…‹ -->
<div class="w-full md:w-1/3 bg-blue-50 p-6">
<h2 class="text-xl font-bold mb-4">æˆ‘æ­£åœ¨å­¸æœƒï¼š</h2>
<div id="skillStatus"></div>
</div>

<!-- å³å´ï¼šé¡Œç›® -->
<div class="flex-1 p-8">

<div id="question" class="big mb-8"></div>

<div id="answers"></div>

<div class="mt-6">
<button onclick="check()" class="btn bg-green-100">æª¢æŸ¥ç­”æ¡ˆ</button>
<button onclick="newQuestion()" class="btn bg-yellow-100">æ›ä¸€é¡Œ</button>
</div>

<div id="feedback" class="mt-6 text-2xl font-bold"></div>

</div>
</main>

<script>
/* ===========================
   æŠ€èƒ½ç´€éŒ„
===========================*/
const skills={
roundUp:{name:"ç„¡æ¢ä»¶é€²å…¥",right:0,wrong:0},
roundDown:{name:"ç„¡æ¢ä»¶æ¨å»",right:0,wrong:0},
round:{name:"å››æ¨äº”å…¥",right:0,wrong:0},
add:{name:"åŠ æ³•ä¼°ç®—",right:0,wrong:0},
mul:{name:"ä¹˜æ³•ä¼°ç®—",right:0,wrong:0},
div:{name:"é™¤æ³•ä¼°ç®—",right:0,wrong:0},
}

if(localStorage.skillData){
Object.assign(skills,JSON.parse(localStorage.skillData))
}

function save(){
localStorage.skillData=JSON.stringify(skills)
renderSkills()
}

/* ===========================
   å‡ºé¡Œï¼ˆçœŸæ­£éš¨æ©Ÿï¼‰
===========================*/

let currentSkill=null
let correctAnswer=0

function newQuestion(){

const types=Object.keys(skills)
currentSkill=types[Math.floor(Math.random()*types.length)]

if(currentSkill==="roundUp"){
const n=Math.floor(Math.random()*8000)+2000
correctAnswer=Math.ceil(n/1000)*1000
setQ(`åƒ¹æ ¼ ${n} å…ƒï¼Œåªèƒ½é ˜åƒå…ƒï¼Œè¦é ˜å¤šå°‘ï¼Ÿ`)
}

if(currentSkill==="roundDown"){
const n=Math.floor(Math.random()*5000)+2000
correctAnswer=Math.floor(n/100)*100
setQ(`${n} å€‹ç‰©å“ï¼Œæ¯100ä¸€çµ„ï¼Œå¯è£å¤šå°‘ï¼Ÿ`)
}

if(currentSkill==="round"){
const n=Math.floor(Math.random()*9000)+1000
correctAnswer=Math.round(n/1000)*1000
setQ(`${n} å››æ¨äº”å…¥åˆ°åƒä½æ˜¯å¤šå°‘ï¼Ÿ`)
}

if(currentSkill==="add"){
const a=Math.floor(Math.random()*40000)+20000
const b=Math.floor(Math.random()*40000)+20000
correctAnswer=Math.round(a/10000)*10000+Math.round(b/10000)*10000
setQ(`${a}+${b} å…ˆå–è¬ä½æ¦‚æ•¸å†ç›¸åŠ `)
}

if(currentSkill==="mul"){
const p=Math.floor(Math.random()*20000)+20000
const n=Math.floor(Math.random()*4)+3
correctAnswer=Math.round(p/1000)*1000*n
setQ(`æ¯äºº${p}å…ƒ å…±${n}äºº ç´„å¤šå°‘ï¼Ÿ`)
}

if(currentSkill==="div"){
const a=Math.floor(Math.random()*4000)+4000
const b=Math.floor(Math.random()*60)+20
correctAnswer=Math.round(a/1000)*1000/Math.round(b/10)*10
correctAnswer=Math.round(correctAnswer)
setQ(`${a}Ã·${b} ç´„å¹¾å€ï¼Ÿ`)
}

}

/* ===========================
   é¡¯ç¤ºé¡Œç›®
===========================*/

function setQ(text){
document.getElementById("question").innerText=text

const opts=[]
opts.push(correctAnswer)
opts.push(correctAnswer*1.1|0)
opts.push(correctAnswer*0.9|0)

opts.sort(()=>Math.random()-0.5)

document.getElementById("answers").innerHTML=opts.map(v=>
`<button class="btn" onclick="select(${v})">${v}</button>`
).join("")
}

let selected=null
function select(v){selected=v}

/* ===========================
   ä½œç­”åˆ¤å®š
===========================*/

function check(){
if(selected===null)return

if(selected===correctAnswer){
skills[currentSkill].right++
document.getElementById("feedback").innerText="ç­”å°äº† ğŸ‘"
}else{
skills[currentSkill].wrong++
document.getElementById("feedback").innerText="å†è©¦è©¦çœ‹"
}

save()
selected=null
}

/* ===========================
   å­¸ç¿’ç‹€æ…‹é¡¯ç¤º
===========================*/

function renderSkills(){
const el=document.getElementById("skillStatus")
el.innerHTML=Object.entries(skills).map(([k,s])=>{
const total=s.right+s.wrong
const rate=total?Math.round(s.right/total*100):0
return `<div class="mb-4">
<b>${s.name}</b><br>
æ­£ç¢ºç‡ï¼š${rate}%ï¼ˆ${s.right}/${total}ï¼‰
</div>`
}).join("")
}

renderSkills()
newQuestion()
</script>
</body>
</html>
